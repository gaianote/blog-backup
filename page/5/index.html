<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta name="description" content="萍水相逢也是前世之缘">
<meta property="og:type" content="website">
<meta property="og:title" content="李云鹏的个人博客">
<meta property="og:url" content="http://gaianote.github.io/page/5/index.html">
<meta property="og:site_name" content="李云鹏的个人博客">
<meta property="og:description" content="萍水相逢也是前世之缘">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="李云鹏的个人博客">
<meta name="twitter:description" content="萍水相逢也是前世之缘">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://gaianote.github.io/page/5/">





  <title>李云鹏的个人博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">李云鹏的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/12/linux/2.解压缩/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/12/linux/2.解压缩/" itemprop="url">linux解压缩命令</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-12T13:17:34+00:00">
                2019-05-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>tar.gz和tar.bz2解压命令<br>网络上下载到linux源码包主要是tar.gz和tar.bz2压缩格式的，有一部分是zip</p>
<p>解压tar.gz命令是</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf xx.tar.gz</span><br></pre></td></tr></table></figure>
<p>解压tar.bz2的命令是</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -jxvf xx.tar.bz2</span><br></pre></td></tr></table></figure>
<p>解压zip则使用unzip工具</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/11/jenkins/2.jenkins与Pipeline/2.pipeline脚本练习/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/11/jenkins/2.jenkins与Pipeline/2.pipeline脚本练习/" itemprop="url">pipeline脚本练习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-11T13:05:39+00:00">
                2019-05-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-在Jenkins上创建一个Pipeline项目"><a href="#1-在Jenkins上创建一个Pipeline项目" class="headerlink" title="1. 在Jenkins上创建一个Pipeline项目"></a>1. 在Jenkins上创建一个Pipeline项目</h2><p>这个可能很多人没有创建过这个类型，基本上大家之前创建的项目都是自由风格的。参考下面这个图，创建一个Pipeline Job.(注：安装Jenkins的向导过程中，选择默认的插件安装，就会有Pipeline组件)</p>
<p><img src="/images/8272832229218.png" alt="img"></p>
<h2 id="2-不集成Github的Pipeline代码"><a href="#2-不集成Github的Pipeline代码" class="headerlink" title="2. 不集成Github的Pipeline代码"></a>2. 不集成Github的Pipeline代码</h2><p>这种方式，直接把写好的Pipeline代码拷贝到Pipeline对应的Jenkins页面上，经常用这个方式来进行本地Debug和单元测试。选择上面创建好的这个Pipeline Job，点击Confige, 到达配置界面，点击Pipeline,然后把代码帖进去，点击保存，具体参考下图。</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">'Build'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                println <span class="string">"Build"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'Test'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                println <span class="string">"Test"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        stage(<span class="string">'Deploy'</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                println <span class="string">"Deploy"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/347832229218.png" alt="img"></p>
<p>上面这个Pipeline模式就是一个典型的Declarative类型，先不管上面具体语法，我们点击保存，然后点击Build Now，看看控制台日志，会发生什么。</p>
<p><img src="/images/127832229218.png" alt="img"></p>
<h2 id="3-集成Github，把Pipeline代码放到Jenkinsfile文件中"><a href="#3-集成Github，把Pipeline代码放到Jenkinsfile文件中" class="headerlink" title="3. 集成Github，把Pipeline代码放到Jenkinsfile文件中"></a>3. 集成Github，把Pipeline代码放到Jenkinsfile文件中</h2><p>这种方式才是开发中使用的场景，任何Pipeline和业务代码一样需要添加到代码仓库。这里我们模仿git，只写Declarative的模式，以后我们都使用Declarative模式的Pipeline代码。</p>
<p>我准备好的github项目地址：<a href="https://github.com/gaianote/learnJenkins.git" target="_blank" rel="noopener">https://github.com/gaianote/learnJenkins.git</a></p>
<p>项目中只有一个Jenkinsfile文本文件，里面写的是Declarative模式的Pipeline代码。下面，继续使用上面创建好的Job，到Configure页面，选择如下图的git拉取Pipeline代码。</p>
<p><img src="/images/432832229212.png" alt="img"></p>
<p>点击保存，然后点击Build Now, 我们会发现jenkins会自动从github上拉取代码，然后开始构建，这种代码拉取，执行文件的方式，运行结果也是成功的，以后我们基本上都是使用这个方式。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/10/jenkins/2.jenkins与Pipeline/1.Pipeline基本介绍/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/10/jenkins/2.jenkins与Pipeline/1.Pipeline基本介绍/" itemprop="url">Pipeline基本介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-10T10:15:31+00:00">
                2019-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这篇是Pipeline学习的Hello World篇，任何新知识开始学习都比较困难。耐心一点，坚持多看一些官网文档。概念积累多了，我们才能运用和尝试一些具体的实战练习。这篇主要介绍，Pipeline的基本概念，包括，什么是Pipeline, Pipeline脚本类型划分，为什么要选择Pipeline，以及Pipeline一些大的概念，细节的知识，我们后续文章会慢慢学习。</p>
<h2 id="1-什么是Pipeline"><a href="#1-什么是Pipeline" class="headerlink" title="1. 什么是Pipeline"></a>1. 什么是Pipeline</h2><pre><code> Jenkins Pipeline是一组插件，支持在Jenkins上实现和集成持续交付的管道。Pipeline这个单词是水管的意思。我以后可能会翻译成管道或者流水线，我建议大家不要翻译，就写Pipeline。这里持续集成（CI）和持续交付（CD），我们在DevOps基础扫盲篇介绍过，以后多经常用到这两个单词缩写。

 Jenkins为了更好支持CI和CD，通过Groovy语言这么DSL（动态描述语言）来开发Pipeline组件。在Jenkins中有一句话，Pipeline as code，Pipeline是Jenkins中最优雅的存在。之前Jenkins上UI操作动作，都可以在Pipeline中代码实现，主要你对Jenkins和Groovy语言有足够多掌握。

 以后我们经常说CI Pipeline和CD Pipeline，你现在大致可以理解为，要实现CD，先要实现CI。CD Pipeline就是一个代码文件，里面把你项目业务场景都通过Groovy代码和Pipeline语法实现，一个一个业务串联起来，全部实现自动化，从代码仓库到生产环境完成部署的自动化流水线。这个过程就是一个典型的CD Pipeline

官网建议我们把Pipeline代码放在一个名称为Jenkinsfile的文本文件中，并且把这个文件放在你项目代码的根目录，采用版本管理工具管理。Jenkinsfile我后面会具体例子来介绍。当然，我们也可以把Pipeline代码用一个Hello.groovy这样的文件去保存在代码库，这也是没问题的。
</code></pre><h2 id="2-Pipeline代码分类和两者区别"><a href="#2-Pipeline代码分类和两者区别" class="headerlink" title="2. Pipeline代码分类和两者区别"></a>2. Pipeline代码分类和两者区别</h2><pre><code>一个Jenkinsfile或者一个Pipeline代码文件，我们可以使用两个脚本模式去写代码，这两种分类叫：Declarative Pipeline 和 Scripted Pipeline. 现在来介绍下两者脚本模式的区别，Declarative相对于Scripted有两个优点。第一个是提供更丰富的语法功能，第二个是写出来的脚本可读性和维护性更好。接下里我们学习的Pipeline语法，其中一部分语法只能在Declarative模式下使用，并不支持Scripted模式。虽然，我在后面文章也会用Declarative和Script两个模式去写同一个场景的Pipeline代码，但是，作为一个初学者，我建议选择并采用Declarative的方式去组织Pipeline代码。
</code></pre><h2 id="3-为什么要选择使用Pipeline"><a href="#3-为什么要选择使用Pipeline" class="headerlink" title="3. 为什么要选择使用Pipeline"></a>3. 为什么要选择使用Pipeline</h2><p>现在Jenkins是一个非常著名的CI服务器平台，支持很多不同第三方（插件的形式）集成自动化测试。<strong>Jenkins UI 配置已经满足不了这么复杂的自动化需求，加入Pipeline功能之后，Jenkins 表现更强大</strong>，Pipeline主要有以下特点</p>
<ul>
<li><p><strong>代码</strong>：Pipeline是用代码去实现，并且支持check in到代码仓库，这样项目团队人员就可以修改，更新Pipeline脚本代码，支持代码迭代。</p>
</li>
<li><p><strong>耐用</strong>：Pipeline支持在Jenkins master(主节点)上计划之内或计划外的重启下也能使用。</p>
</li>
<li><p><strong>可暂停</strong>：Pipeline支持可选的停止和恢复或者等待批准之后再跑Pipeline代码。</p>
</li>
<li><p><strong>丰富功能</strong>：Pipeline支持复杂和实时的CD需求，包括循环，拉取代码，和并行执行的能力。</p>
</li>
<li><p><strong>可扩展性</strong>：Pipeline支持DSL的自定义插件扩展和支持和其他插件的集成。</p>
</li>
</ul>
<h2 id="4-Pipeline的基本流程"><a href="#4-Pipeline的基本流程" class="headerlink" title="4. Pipeline的基本流程"></a>4. Pipeline的基本流程</h2><p>上面这段话提到的“主节点”，“批准” 我会后续用具体例子介绍，帮你理解这里说到的好处。这个可扩展性，可能我没法实现，暂时没有研究这么深入。在第节点里面提到的CD Pipeline和本节点提到的Pipeline可以添加到代码仓库管理，通过下面这个CD Pipeline的流程图，我们知道一个CD流程大致包含这些业务场景。</p>
<p><img src="/images/827832229322.png" alt="img"></p>
<ol>
<li>开发提交代码到项目仓库服务器</li>
<li>开始执行Pipeline代码文件，开始从仓库check out代码</li>
<li>启动Pipeline里面第一个stage，stage就是阶段的意思，后面会介绍语法</li>
<li>图里面第一个Stage应该是代码打包构建（Build）</li>
<li>然后进入测试的阶段，执行各种自动化测试验证</li>
<li>然后测试结束，到运维的部署阶段。</li>
<li>部署结束，输出报告，整个自动化流程工作完成，等待触发构建，开始重复下一轮1到7步骤。</li>
</ol>
<h2 id="5-Pipeline的大的一些概念基础"><a href="#5-Pipeline的大的一些概念基础" class="headerlink" title="5. Pipeline的大的一些概念基础"></a>5. Pipeline的大的一些概念基础</h2><p>这里开始介绍一些大的并且很基础的概念，更多、更具体的Pipeline语法，我后续文章来介绍。</p>
<h3 id="1-pipeline"><a href="#1-pipeline" class="headerlink" title="1. pipeline"></a>1. pipeline</h3><p>这个单词是小写，可以看作是Pipeline语法中的一个关键字。以后一个groovy文件或者一个Jenkinsfile文件中不光只有Pipeline代码，例如还有其他的工具类方法等。通过pipeline { Pipeline代码}，这个关键字就是告诉Jenkins接下来{}中的代码就是pipeline代码，和普通的函数或者方法隔离出来。</p>
<h3 id="2-node"><a href="#2-node" class="headerlink" title="2. node"></a>2. node</h3><p>关键字node就是用来区分，Jenkins环境中不同的节点环境。例如一个Jenkins环境包括master节点，也就是主节点，还包括N多个从节点，这些从节点在添加到主节点的向导页面中有一个参数，好像是label，就是给这个从节点取一个名称。在Pipeline代码中可以通过node这个关键字告诉Jenkins去用哪一台节点机器去执行代码。</p>
<h3 id="3-stage"><a href="#3-stage" class="headerlink" title="3. stage"></a>3. stage</h3><p>关键字stage，就是一段代码块，一般个stage包含一个业务场景的自动化，例如build是一个stage, test是第二个stage，deploy是第三个stage。通过stage隔离，让Pipeline代码读写非常直观。到后面你还会学习stages这个关键字，一个stages包含多个stage。</p>
<h3 id="4-step"><a href="#4-step" class="headerlink" title="4. step"></a>4. step</h3><p>关键字step就是一个简单步骤，一般就是几行代码或者调用外部一个模块类的具体功能。这里step是写在stage的大括号里的。</p>
<p>以上就是Pipeline的基础语法内容，下一篇，介绍Declarative Pipeline 和 Scripted Pipeline在Jenkins环境上的实战练习，并解释没一行代码的含义，顺便复习一下Pipeline的基础语法，也就是pipeline, node, stage, step这几个关键字的使用。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/07/jenkins/1.jenkins基础入门/23.持续集成的意义/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/07/jenkins/1.jenkins基础入门/23.持续集成的意义/" itemprop="url">持续集成的意义</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-07T13:50:06+00:00">
                2019-05-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>作者： <a href="http://www.ruanyifeng.com/" target="_blank" rel="noopener">阮一峰</a></p>
<p>互联网软件的开发和发布，已经形成了一套标准流程，最重要的组成部分就是持续集成（Continuous integration，简称CI）。</p>
<p>本文简要介绍持续集成的概念和做法。</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015092301.png" alt="img"></p>
<h2 id="1-概念"><a href="#1-概念" class="headerlink" title="1. 概念"></a>1. 概念</h2><p><strong>持续集成指的是，频繁地（一天多次）将代码集成到主干。</strong></p>
<p>它的好处主要有两个。</p>
<blockquote>
<p><strong>（1）快速发现错误。</strong>每完成一点更新，就集成到主干，可以快速发现错误，定位错误也比较容易。</p>
<p><strong>（2）防止分支大幅偏离主干。</strong>如果不是经常集成，主干又在不断更新，会导致以后集成的难度变大，甚至难以集成。</p>
</blockquote>
<p><strong>持续集成的目的，就是让产品可以快速迭代，同时还能保持高质量。</strong>它的核心措施是，代码集成到主干之前，必须通过自动化测试。只要有一个测试用例失败，就不能集成。</p>
<p>Martin Fowler说过，”持续集成并不能消除Bug，而是让它们非常容易发现和改正。”</p>
<p>与持续集成相关的，还有两个概念，分别是持续交付和持续部署。</p>
<h2 id="2-持续交付"><a href="#2-持续交付" class="headerlink" title="2. 持续交付"></a>2. 持续交付</h2><p><strong>持续交付（Continuous delivery）指的是，频繁地将软件的新版本，交付给质量团队或者用户，以供评审。</strong>如果评审通过，代码就进入生产阶段。</p>
<p>持续交付可以看作持续集成的下一步。它强调的是，不管怎么更新，软件是随时随地可以交付的。</p>
<h2 id="3-持续部署"><a href="#3-持续部署" class="headerlink" title="3. 持续部署"></a>3. 持续部署</h2><p><strong>持续部署（continuous deployment）是持续交付的下一步，指的是代码通过评审以后，自动部署到生产环境。</strong></p>
<p>持续部署的目标是，代码在任何时刻都是可部署的，可以进入生产阶段。</p>
<p>持续部署的前提是能自动化完成测试、构建、部署等步骤。它与持续交付的区别，可以参考下图。</p>
<p><img src="http://www.ruanyifeng.com/blogimg/asset/2015/bg2015092302.jpg" alt="img"></p>
<h2 id="4-流程"><a href="#4-流程" class="headerlink" title="4. 流程"></a>4. 流程</h2><p>根据持续集成的设计，代码从提交到生产，整个过程有以下几步。</p>
<h3 id="4-1-提交"><a href="#4-1-提交" class="headerlink" title="4.1 提交"></a>4.1 提交</h3><p>流程的第一步，是开发者向代码仓库提交代码。所有后面的步骤都始于本地代码的一次提交（commit）。</p>
<h3 id="4-2-测试（第一轮）"><a href="#4-2-测试（第一轮）" class="headerlink" title="4.2 测试（第一轮）"></a>4.2 测试（第一轮）</h3><p>代码仓库对commit操作配置了钩子（hook），只要提交代码或者合并进主干，就会跑自动化测试。</p>
<p>测试有好几种。</p>
<blockquote>
<ul>
<li>单元测试：针对函数或模块的测试</li>
<li>集成测试：针对整体产品的某个功能的测试，又称功能测试</li>
<li>端对端测试：从用户界面直达数据库的全链路测试</li>
</ul>
</blockquote>
<p>第一轮至少要跑单元测试。</p>
<h3 id="4-3-构建"><a href="#4-3-构建" class="headerlink" title="4.3 构建"></a>4.3 构建</h3><p>通过第一轮测试，代码就可以合并进主干，就算可以交付了。</p>
<p>交付后，就先进行构建（build），再进入第二轮测试。所谓构建，指的是将源码转换为可以运行的实际代码，比如安装依赖，配置各种资源（样式表、JS脚本、图片）等等。</p>
<p>常用的构建工具如下。</p>
<blockquote>
<ul>
<li><a href="http://jenkins-ci.org/" target="_blank" rel="noopener">Jenkins</a></li>
<li><a href="https://travis-ci.com/" target="_blank" rel="noopener">Travis</a></li>
<li><a href="https://www.codeship.io/" target="_blank" rel="noopener">Codeship</a></li>
<li><a href="http://stridercd.com/" target="_blank" rel="noopener">Strider</a></li>
</ul>
</blockquote>
<p>Jenkins和Strider是开源软件，Travis和Codeship对于开源项目可以免费使用。它们都会将构建和测试，在一次运行中执行完成。</p>
<h3 id="4-4-测试（第二轮）"><a href="#4-4-测试（第二轮）" class="headerlink" title="4.4 测试（第二轮）"></a>4.4 测试（第二轮）</h3><p>构建完成，就要进行第二轮测试。如果第一轮已经涵盖了所有测试内容，第二轮可以省略，当然，这时构建步骤也要移到第一轮测试前面。</p>
<p>第二轮是全面测试，单元测试和集成测试都会跑，有条件的话，也要做端对端测试。所有测试以自动化为主，少数无法自动化的测试用例，就要人工跑。</p>
<p>需要强调的是，新版本的每一个更新点都必须测试到。如果测试的覆盖率不高，进入后面的部署阶段后，很可能会出现严重的问题。</p>
<h3 id="4-5-部署"><a href="#4-5-部署" class="headerlink" title="4.5 部署"></a>4.5 部署</h3><p>通过了第二轮测试，当前代码就是一个可以直接部署的版本（artifact）。将这个版本的所有文件打包（ <code>tar filename.tar *</code> ）存档，发到生产服务器。</p>
<p>生产服务器将打包文件，解包成本地的一个目录，再将运行路径的符号链接（symlink）指向这个目录，然后重新启动应用。这方面的部署工具有<a href="http://www.ansible.com/" target="_blank" rel="noopener">Ansible</a>，<a href="https://www.chef.io/chef/" target="_blank" rel="noopener">Chef</a>，<a href="https://puppetlabs.com/" target="_blank" rel="noopener">Puppet</a>等。</p>
<h3 id="4-6-回滚"><a href="#4-6-回滚" class="headerlink" title="4.6 回滚"></a>4.6 回滚</h3><p>一旦当前版本发生问题，就要回滚到上一个版本的构建结果。最简单的做法就是修改一下符号链接，指向上一个版本的目录。</p>
<h2 id="5-值得借鉴的流程"><a href="#5-值得借鉴的流程" class="headerlink" title="5. 值得借鉴的流程"></a>5. 值得借鉴的流程</h2><p>某评论内容:</p>
<blockquote>
<p>阮老师讲的“持续集成”，正好是我在公司做了将近半年多互联网项目的一个工作流程。我们项目经历了两期，每期都要进行十几次迭代，每次迭代都会在上一个迭代的基础上增加几个新功能，并且公司要求开发人员在编码前要先提交该功能的单体测试和集成测试的代码，然后才能开始写代码（所谓的测试驱动开发），然后测试人员要负责写端到端的自动化测试代码。公司用Jenkins进行持续集成，SVN管理代码库，Git进行团队开发，Sonar进行代码质量检查。项目成员每天早晨都会收到Jenkins服务器发来的前一天的集成测试报告，通知前一天的提交是否完全通过。经历了这样一个持续迭代的过程，给客户交付的代码质量有保证，很少或几乎没有出现过回滚的情况。</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/05/jenkins/1.jenkins基础入门/22.html_report插件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/05/jenkins/1.jenkins基础入门/22.html_report插件/" itemprop="url">html_report插件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-05T15:34:35+00:00">
                2019-05-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="UI-界面上Publish-HTML-reports的使用"><a href="#UI-界面上Publish-HTML-reports的使用" class="headerlink" title="UI 界面上Publish HTML reports的使用"></a>UI 界面上Publish HTML reports的使用</h2><h3 id="1-安装"><a href="#1-安装" class="headerlink" title="1. 安装"></a>1. 安装</h3><p>在插件管理的Available项，搜索 <code>html publisher</code> 以安装插件。安装好Publisher HTML plugin之后，会在新建或者编辑项目时，在【增加构建后操作步骤】出现【Publish HTML reports】的选项。如下：</p>
<p><img src="/images/417871348249418.png" alt="img"></p>
<h3 id="2-配置"><a href="#2-配置" class="headerlink" title="2. 配置"></a>2. 配置</h3><p>点击上面构建步骤后，在这里会出现配置项目：</p>
<p><img src="/images/417876282904053.png" alt="img"></p>
<h3 id="3-测试报告"><a href="#3-测试报告" class="headerlink" title="3.测试报告"></a>3.测试报告</h3><p>测试报告最终的输出目录为%workspace%/$reportDir/$reportFiles</p>
<p>这个插件不会自动按照上面的路径创建文件夹和文件，所以，一定要确保上面路径上的文件夹和文件已经在工作空间创建好，不然会出现报错。也就是说，这个插件是不创建任何html内容的</p>
<p><img src="/images/1557459385849.png" alt="img"></p>
<h2 id="2-Pipeline-上Publish-HTML-reports的使用"><a href="#2-Pipeline-上Publish-HTML-reports的使用" class="headerlink" title="2. Pipeline 上Publish HTML reports的使用"></a>2. Pipeline 上Publish HTML reports的使用</h2><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">post&#123;</span><br><span class="line">        always&#123;</span><br><span class="line">            script&#123;</span><br><span class="line">                    publishHTML (<span class="string">target:</span> [</span><br><span class="line"><span class="symbol">                        allowMissing:</span> <span class="literal">false</span>,</span><br><span class="line"><span class="symbol">                        alwaysLinkToLastBuild:</span> <span class="literal">false</span>,</span><br><span class="line"><span class="symbol">                        keepAll:</span> <span class="literal">true</span>,</span><br><span class="line"><span class="symbol">                        reportDir:</span> <span class="string">'report'</span>,</span><br><span class="line"><span class="symbol">                        reportFiles:</span> <span class="string">'index.html'</span>,</span><br><span class="line"><span class="symbol">                        reportName:</span> <span class="string">"HTML Report"</span></span><br><span class="line">                    ])</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>reportDir，就是你项目中保存html文件的地方，这里写‘test-output’是一个相对路径写法，默认从你项目根路面开始，所以，这里我们写test-output就行。第二个参数reportFiles，我写了index.html，这个要和前面extentreport代码设置报告名称一致。这个地方可以同时写多个html文件，逗号隔开。第三个参数reportName，这个参数写的字符串会在Jenkins构建Job页面显示的菜单名称，后面会看到这个名称，这个名称可以随意修改，例如改成selenium report。</p>
<h2 id="3-为测试报告开启CSS和js"><a href="#3-为测试报告开启CSS和js" class="headerlink" title="3. 为测试报告开启CSS和js"></a>3. 为测试报告开启CSS和js</h2><p>由于Jenkins中的内容安全策略，<a href="https://wiki.jenkins-ci.org/display/JENKINS/Configuring+Content+Security+Policy" target="_blank" rel="noopener">CSS是被禁止的。</a></p>
<blockquote>
<p><strong>The default rule is set to:</strong></p>
<p>sandbox; default-src ‘none’; img-src ‘self’; style-src ‘self’;<br>This rule set results in the following:</p>
<p>No JavaScript allowed at all<br>No plugins (object/embed) allowed<br>No inline CSS, or CSS from other sites allowed<br>No images from other sites allowed<br>No frames allowed<br>No web fonts allowed<br>No XHR/AJAX allowed, etc.</p>
</blockquote>
<p>解决方案如下：</p>
<p>进入系统管理-&gt;script Console-&gt;输入下面的命令：</p>
<p><img src="/images/1560927214666.png" alt="img"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">System.setProperty(<span class="string">"hudson.model.DirectoryBrowserSupport.CSP"</span>, <span class="string">""</span>)</span><br></pre></td></tr></table></figure>
<p>然后按<strong><code>RUN</code></strong>。如果在<strong><code>RESULT</code></strong>标题下面看到输出为<strong><code>RESULT</code></strong>，则禁用保护。重新运行您的构建，您可以看到存档的新HTML文件将启用CSS。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/05/jenkins/1.jenkins基础入门/20.批量删除构建历史/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/05/jenkins/1.jenkins基础入门/20.批量删除构建历史/" itemprop="url">jenkins密钥管理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-05T10:10:32+00:00">
                2019-05-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Jenkins构建后会生成历史记录，默认存放在如下目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Jenkins_home/<span class="built_in">jobs</span>/build_project_name/builds/</span><br></pre></td></tr></table></figure>
<p> Linux下，Jenkins_home默认为<code>/root/.jenkins</code></p>
<p>如果因磁盘空间存储等原因，想批量删除构建历史记录，可进入该目录，删除全部文件，然后重启Jenkins即可。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/04/jenkins/1.jenkins基础入门/19.密钥管理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/04/jenkins/1.jenkins基础入门/19.密钥管理/" itemprop="url">jenkins密钥管理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-04T11:50:32+00:00">
                2019-05-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="密钥管理"><a href="#密钥管理" class="headerlink" title="密钥管理"></a>密钥管理</h2><p>我们在使用git和svn拉取时，创建的密钥，通过点击主页面-&gt;左侧Credentials 进行管理。使用方法如下：</p>
<p><img src="/images/1557725417485.png" alt="img"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/03/jenkins/1.jenkins基础入门/17.jenkins主从节点配置/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/03/jenkins/1.jenkins基础入门/17.jenkins主从节点配置/" itemprop="url">新UI界面Blue Ocean</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-03T11:22:34+00:00">
                2019-05-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="在新主机添加slave节点"><a href="#在新主机添加slave节点" class="headerlink" title="在新主机添加slave节点"></a>在新主机添加slave节点</h2><h3 id="1-将密钥传送到子节点"><a href="#1-将密钥传送到子节点" class="headerlink" title="1. 将密钥传送到子节点"></a>1. 将密钥传送到子节点</h3><p>A为主节点master，B为从节点slave</p>
<p>SSH登录A，如果还没有SSH密钥，则先生成SSH密钥，执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen</span><br></pre></td></tr></table></figure>
<p>全部按Enter使用默认值。</p>
<p>有了密钥之后，将密钥传送到远程主机B，执行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-copy-id &lt;user-name&gt;@&lt;remote-hostB&gt;</span><br></pre></td></tr></table></figure>
<p>这样，我下次登录<remote-host>上的<user-name>账户时就不需要密码了</user-name></remote-host></p>
<h3 id="2-设置launch-method相关信息"><a href="#2-设置launch-method相关信息" class="headerlink" title="2. 设置launch method相关信息"></a>2. 设置launch method相关信息</h3><ol>
<li>HOST填写slave的ip地址</li>
<li>Credentials填写ssh认证信息</li>
<li>Host key Verification选择 Manually trusted key Verification Strategy</li>
</ol>
<p><img src="/images/1557583221113.png" alt="img"></p>
<h3 id="3-填写SSH认证信息"><a href="#3-填写SSH认证信息" class="headerlink" title="3. 填写SSH认证信息"></a>3. 填写SSH认证信息</h3><p>如果你还没有验证信息，请点击上图中的 <code>Add</code> 添加验证信息</p>
<p>在private_key填入master节点上的私钥内容，使用<code>cat /root/.ssh/id_rsa</code>查看</p>
<p>注意的是，<code>username</code>也要匹配，比如你<code>ssh-copy-id</code> <code>root</code>用户免登陆，则username那里需要填写 <code>root</code></p>
<p><img src="/images/1560930551008.png" alt="img"></p>
<h3 id="4-限制此项目可以运行的位置"><a href="#4-限制此项目可以运行的位置" class="headerlink" title="4. 限制此项目可以运行的位置"></a>4. 限制此项目可以运行的位置</h3><p>新建JOB时，在General &gt; Restrict where this project can be run下，填写需要JOB运行的节点名称<br><img src="/images/1557587113744.png" alt="img"></p>
<h3 id="5-复制节点"><a href="#5-复制节点" class="headerlink" title="5. 复制节点"></a>5. 复制节点</h3><p>对于多个节点，我们在发送私钥后，就可以通过复制旧的节点快速创建新节点，只需要修改ip地址即可。</p>
<p><img src="/images/1560930854463.png" alt="img"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/02/jenkins/1.jenkins基础入门/16.新UI界面Blue_Ocean/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/02/jenkins/1.jenkins基础入门/16.新UI界面Blue_Ocean/" itemprop="url">新UI界面Blue Ocean</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-02T10:25:31+00:00">
                2019-05-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="1-在插件管理安装Blue-Ocean"><a href="#1-在插件管理安装Blue-Ocean" class="headerlink" title="1. 在插件管理安装Blue Ocean"></a>1. 在插件管理安装Blue Ocean</h2><p>在可选插件中输入 blue ocean 搜索，可以看到一大堆和blue ocean相关的插件，你只需要勾选Blue Ocean那个，会自动帮你安装其他依赖的插件，这个安装成功是否，取决于你的网速，如果安装失败，重启，再来一次。</p>
<p><img src="/images/20171016225423734.png" alt="img"></p>
<p>安装完，建议重启下jenkins服务。</p>
<h2 id="2-如何从旧版本Jenkins切换到蓝海的皮肤版本"><a href="#2-如何从旧版本Jenkins切换到蓝海的皮肤版本" class="headerlink" title="2. 如何从旧版本Jenkins切换到蓝海的皮肤版本"></a>2. 如何从旧版本Jenkins切换到蓝海的皮肤版本</h2><p><img src="/images/20171016225513020.png" alt="img">安装完插件后，点击左侧红圈这个地方的入口。</p>
<h2 id="Jenkins的Blue-Ocean默认界面"><a href="#Jenkins的Blue-Ocean默认界面" class="headerlink" title="Jenkins的Blue Ocean默认界面"></a>Jenkins的Blue Ocean默认界面</h2><p><img src="/images/20171016225513021.png" alt="img"></p>
<p>这个界面看起来特别干净，清爽。好像，现在很多基于云的相关的前端页面都是采用这个风格开发的。点击顶部向右那个ICON就回到了经典的Jenkins界面。关于在蓝海皮肤下的操作就简单介绍到这里，你自己点击，看看，这个很可能未来哪个版本就采用这个皮肤来取代当前的经典皮肤。这个蓝海皮肤有一个前提条件就是你的jenkins版本必须要2.7以上，否则是不支持这个插件的</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://gaianote.github.io/2019/05/01/jenkins/1.jenkins基础入门/15.Jenkins中的Pipeline/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="李云鹏">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/rem.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李云鹏的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/01/jenkins/1.jenkins基础入门/15.Jenkins中的Pipeline/" itemprop="url">Jenkins与Pipeline</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-01T10:25:31+00:00">
                2019-05-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>继续来学习Jenkins的基本知识。本篇来介绍Pipeline，首先什么是Pipeline，如何你百度一下这个单词，会告诉你是管道的意思。那么Jenkins中为什么引入管道的概念呢。其实Pileline在Jenkins中是一种工具，一个插件，用来监控Job的构建过程。</p>
<h2 id="1-什么是Pipeline"><a href="#1-什么是Pipeline" class="headerlink" title="1.什么是Pipeline"></a>1.什么是Pipeline</h2><p>我们已经知道对应的中文是管道的意思，例如下面这个图，就是一个管道，生活中的自来水管，就是像下面这张图，由多个分支拼接而成。</p>
<p><img src="/images/82783222932.png" alt="img"></p>
<p>在Jenkins中，把每一段管道比作是不同的Job，不同Job的链接，这个时候就是Pipeline插件闪亮登场。前面我们提到Jenkins的工作流程，build-deploy-test-release，每个流程之间我们都可以用Pipeline来连接，大致如下效果图。</p>
<p><img src="/images/8278322292128.png" alt="img"></p>
<h2 id="2-Jenkins上安装Pipeline"><a href="#2-Jenkins上安装Pipeline" class="headerlink" title="2. Jenkins上安装Pipeline"></a>2. Jenkins上安装Pipeline</h2><p>我们直接在插件管理，搜索 <code>Delivery pipeline</code>，然后点击安装，会自动安装依赖的包和插件。</p>
<p><img src="/images/8278322292181.png" alt="img"></p>
<h2 id="3-初步了解Pipeline的效果"><a href="#3-初步了解Pipeline的效果" class="headerlink" title="3. 初步了解Pipeline的效果"></a>3. 初步了解Pipeline的效果</h2><p>这里，我们百度图片搜索输入jenkins pipeline,多看几张图片，就可以看到下面这张图的效果。</p>
<p><img src="/images/8278322292112.png" alt="img"></p>
<p>从上面来看，如果是一个复杂的项目，有了pipeline，就很清楚了解每个阶段构建消耗时间和整个构建的流程走向图，很清晰地感觉。本篇，主要是对Pipeline有一个基本的了解就可以。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="extend next" rel="next" href="/page/6/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/rem.png" alt="李云鹏">
            
              <p class="site-author-name" itemprop="name">李云鹏</p>
              <p class="site-description motion-element" itemprop="description">萍水相逢也是前世之缘</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">220</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李云鹏</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      本站访客数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人次
    </span>
  

  
    <span class="site-pv">
      本站总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
